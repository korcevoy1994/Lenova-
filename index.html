<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ Lenovo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/supabase/2.39.7/umd/supabase.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 800px;
            width: 90%;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #e60028, #ff6b35);
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: #e60028;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #e60028;
            box-shadow: 0 0 0 3px rgba(230, 0, 40, 0.1);
        }

        .btn {
            background: linear-gradient(45deg, #e60028, #ff4757);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(230, 0, 40, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(230, 0, 40, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .question-container {
            text-align: left;
            margin-bottom: 30px;
        }

        .question-number {
            color: #e60028;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            text-align: left;
            font-weight: 500;
        }

        .option:hover {
            border-color: #e60028;
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .option.selected {
            background: #f8f9ff;
            border-color: #667eea;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e60028, #ff6b35);
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .results {
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px auto;
            font-size: 2em;
            font-weight: bold;
            color: white;
            position: relative;
        }

        .score-excellent {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .score-good {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
        }

        .score-poor {
            background: linear-gradient(45deg, #dc3545, #e74c3c);
        }

        .leaderboard {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 30px;
        }

        .leaderboard table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .leaderboard th,
        .leaderboard td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .leaderboard th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .leaderboard tr:hover {
            background: #f8f9ff;
        }

        .rank-medal {
            font-size: 1.2em;
            margin-right: 10px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #e60028;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 20px;
            }
            
            .logo {
                font-size: 2em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .btn {
                padding: 12px 30px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">LENOVO</div>
        <div class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞</div>

        <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
        <div id="loginScreen" class="screen active">
            <div class="input-group">
                <label for="playerName">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</label>
                <input type="text" id="playerName" placeholder="–í–∞—à–µ –∏–º—è" maxlength="50">
            </div>
            <button class="btn" onclick="startQuiz()">–ù–∞—á–∞—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É</button>
            <br><br>
            <button class="btn btn-secondary" onclick="showLeaderboard()">–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã -->
        <div id="quizScreen" class="screen">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="question-container">
                <div class="question-number" id="questionNumber"></div>
                <div class="question-text" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
            </div>
            
            <button class="btn" id="nextBtn" onclick="nextQuestion()" style="display: none;">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="resultsScreen" class="screen">
            <h2>–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
            <div class="score-circle" id="scoreCircle">
                <div id="scoreText"></div>
            </div>
            <div id="resultDetails"></div>
            <button class="btn" onclick="restartQuiz()">–ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞</button>
            <button class="btn btn-secondary" onclick="showLeaderboard()">–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="leaderboardScreen" class="screen">
            <h2>–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
            <div class="leaderboard" id="leaderboardContainer">
                <div class="loading"></div>
            </div>
            <button class="btn btn-secondary" onclick="showLogin()">–ù–∞–∑–∞–¥ –∫ –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ</button>
        </div>

        <div id="errorMessage" class="error-message" style="display: none;"></div>
        <div id="successMessage" class="success-message" style="display: none;"></div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase
        const SUPABASE_URL = 'https://qoqxxvpihxctegnlpztl.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFvcXh4dnBpaHhjdGVnbmxwenRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA0MjQyMjQsImV4cCI6MjA2NjAwMDIyNH0.nj503HOh4qgo4JlNq06lf8mPCF1sp9zr5o0iATwkrc4';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
        let supabase;
        
        try {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        } catch (error) {
            console.log('Supabase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ.');
        }

        console.log('Supabase:', supabase);

        // –í–æ–ø—Ä–æ—Å—ã –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
        const questions = [
            {
                question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É –±—ã–ª–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è Lenovo?",
                options: ["1980", "1984", "1990", "1995"],
                correct: 1
            },
            {
                question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ Lenovo –¥–ª—è edge-–∫–æ–º–ø—å—é—Ç–∏–Ω–≥–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ò–ò?",
                options: ["ThinkAI", "Lenovo Edge", "ThinkEdge", "SmartCompute"],
                correct: 2
            },
            {
                question: "–í —Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç Lenovo –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É?",
                options: ["60", "100", "160", "200"],
                correct: 2
            },
            {
                question: "–ö–∞–∫ –∑–≤—É—á–∏—Ç –≤–∏–¥–µ–Ω–∏–µ Lenovo –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π?",
                options: ["–£–º–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è –≤—Å–µ—Ö", "–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ", "–°–∏–ª–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞", "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è –∂–∏–∑–Ω–∏"],
                correct: 0
            },
            {
                question: "–ù–∞ –∑–∞—â–∏—Ç—É —á–µ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ThinkShield?",
                options: ["–¢–æ–ª—å–∫–æ –∞–ø–ø–∞—Ä–∞—Ç—É—Ä—ã", "–¢–æ–ª—å–∫–æ –ü–û", "–£—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –¥–∞–Ω–Ω—ã—Ö (End-to-end devices and data)", "–¢–æ–ª—å–∫–æ –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤"],
                correct: 2
            },
            {
                question: "–î–ª—è —á–µ–≥–æ —Å–ª—É–∂–∏—Ç —É—Å–ª—É–≥–∞ CO2 Offset –æ—Ç Lenovo?",
                options: ["–£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤–µ—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞", "–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —É–≥–ª–µ—Ä–æ–¥–Ω–æ–≥–æ —Å–ª–µ–¥–∞ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∏ –¥–æ—Å—Ç–∞–≤–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤", "–ü–æ–≤—ã—à–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ —Å–ª—É–∂–±—ã –±–∞—Ç–∞—Ä–µ–∏", "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏"],
                correct: 1
            },
            {
                question: "–ö–∞–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ Lenovo –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è ¬´—É–º–Ω—ã—Ö¬ª –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç?",
                options: ["ThinkSmart", "SmartOffice", "Lenovo Meet", "ThinkConnect"],
                correct: 0
            },
            {
                question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ Lenovo?",
                options: ["Lenovo Alliance", "Lenovo 360", "PartnerFirst", "ThinkPartner"],
                correct: 1
            },
            {
                question: "–ö–∞–∫–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è –æ—Ç Lenovo –±—ã–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ì—Ä–∞–Ω-–ø—Ä–∏ –°–®–ê –§–æ—Ä–º—É–ª—ã 1 –≤ 2023 –≥–æ–¥—É?",
                options: ["–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –±–æ–ª–∏–¥", "–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ç–æ—Ä", "–ö—É–±–∫–∏, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º—ã–µ –ø–æ—Ü–µ–ª—É–µ–º", "–ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ñ–ª–∞–≥"],
                correct: 2
            },
            {
                question: "–ö–∞–∫ Lenovo –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –≤ —Ä–∞–º–∫–∞—Ö –ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–∞ —Å –§–æ—Ä–º—É–ª–æ–π 1?",
                options: ["–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–ª–Ω–µ—á–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –Ω–∞ —Ç—Ä–∞—Å—Å–∞—Ö", "–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–∫–∞—Ä—ã –¥–ª—è –∫–æ–º–∞–Ω–¥", "–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É 95% —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è", "–°–ø–æ–Ω—Å–∏—Ä—É–µ—Ç –ø–æ—Å–∞–¥–∫—É –¥–µ—Ä–µ–≤—å–µ–≤"],
                correct: 2
            }
        ];

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentPlayer = '';
        let currentQuestion = 0;
        let playerAnswers = [];
        let correctAnswers = 0;

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // –ù–∞—á–∞—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É
        function startQuiz() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è');
                return;
            }

            currentPlayer = name;
            currentQuestion = 0;
            playerAnswers = [];
            correctAnswers = 0;

            showScreen('quizScreen');
            displayQuestion();
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å
        function displayQuestion() {
            const question = questions[currentQuestion];
            
            document.getElementById('questionNumber').textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestion + 1} –∏–∑ ${questions.length}`;
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                optionDiv.onclick = () => selectOption(index);
                optionDiv.dataset.index = index;
                optionsContainer.appendChild(optionDiv);
            });

            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            const progress = (currentQuestion / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('nextBtn').style.display = 'none';
        }

        // –í—ã–±—Ä–∞—Ç—å –æ–ø—Ü–∏—é
        function selectOption(selectedIndex) {
            const question = questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            
            // –û—Ç–∫–ª—é—á–∏—Ç—å –∫–ª–∏–∫–∏ –ø–æ –æ–ø—Ü–∏—è–º
            options.forEach(option => {
                option.style.pointerEvents = 'none';
            });

            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç—ã
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('incorrect');
                }
            });

            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç
            playerAnswers.push({
                question: question.question,
                selected: selectedIndex,
                correct: question.correct,
                isCorrect: selectedIndex === question.correct
            });

            if (selectedIndex === question.correct) {
                correctAnswers++;
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å"
            setTimeout(() => {
                document.getElementById('nextBtn').style.display = 'block';
            }, 1500);
        }

        // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion < questions.length) {
                displayQuestion();
            } else {
                finishQuiz();
            }
        }

        // –ó–∞–≤–µ—Ä—à–∏—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É
        async function finishQuiz() {
            const score = correctAnswers;
            const percentage = Math.round((score / questions.length) * 100);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            showScreen('resultsScreen');
            displayResults(score, percentage);
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            await saveResult(currentPlayer, score, questions.length, percentage);
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function displayResults(score, percentage) {
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreText = document.getElementById('scoreText');
            
            scoreText.textContent = `${score}/${questions.length}`;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            if (percentage >= 80) {
                scoreCircle.className = 'score-circle score-excellent';
            } else if (percentage >= 60) {
                scoreCircle.className = 'score-circle score-good';
            } else {
                scoreCircle.className = 'score-circle score-poor';
            }

            // –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            let resultText = `<h3>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, ${currentPlayer}!</h3>`;
            resultText += `<p>–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ <strong>${score}</strong> –∏–∑ <strong>${questions.length}</strong> –≤–æ–ø—Ä–æ—Å–æ–≤ (${percentage}%)</p>`;
            
            if (percentage >= 80) {
                resultText += `<p style="color: #28a745;">üéâ –û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç –ø–æ Lenovo!</p>`;
            } else if (percentage >= 60) {
                resultText += `<p style="color: #ffc107;">üëç –•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –£ –≤–∞—Å –µ—Å—Ç—å —Ö–æ—Ä–æ—à–∏–µ –∑–Ω–∞–Ω–∏—è –æ Lenovo!</p>`;
            } else {
                resultText += `<p style="color: #dc3545;">üìö –ï—Å—Ç—å –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏–∑—É—á–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ Lenovo!</p>`;
            }

            document.getElementById('resultDetails').innerHTML = resultText;
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Supabase
        async function saveResult(playerName, score, totalQuestions, percentage) {
            if (!supabase) {
                console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ');
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('quiz_results')
                    .insert([
                        {
                            player_name: playerName,
                            score: score,
                            total_questions: totalQuestions,
                            percentage: percentage,
                            completed_at: new Date().toISOString()
                        }
                    ]);

                if (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:', error);
                    showError('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö');
                } else {
                    showSuccess('–†–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
                }

                console.log('–°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:', { playerName, score, totalQuestions, percentage });
                console.log('–û—Ç–≤–µ—Ç Supabase:', data, error);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö:', error);
                showError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        async function showLeaderboard() {
            showScreen('leaderboardScreen');
            await loadLeaderboard();
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        async function loadLeaderboard() {
            const container = document.getElementById('leaderboardContainer');
            container.innerHTML = '<div class="loading"></div>';

            if (!supabase) {
                container.innerHTML = `
                    <div class="error-message">
                        <p>–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase.</p>
                        <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SUPABASE_URL –∏ SUPABASE_ANON_KEY –≤ –∫–æ–¥–µ.</p>
                    </div>
                `;
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('quiz_results')
                    .select('*')
                    .order('percentage', { ascending: false })
                    .order('completed_at', { ascending: true });

                if (error) {
                    throw error;
                }

                displayLeaderboardData(data);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', error);
                container.innerHTML = `
                    <div class="error-message">
                        <p>–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ${error.message}</p>
                        <p>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ 'quiz_results' —Å–æ–∑–¥–∞–Ω–∞ –≤ Supabase.</p>
                    </div>
                `;
            }
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayLeaderboardData(results) {
            const container = document.getElementById('leaderboardContainer');
            
            if (!results || results.length === 0) {
                container.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
                return;
            }

            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–º—è</th>
                            <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                            <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                            <th>–î–∞—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            results.forEach((result, index) => {
                const rank = index + 1;
                let medal = '';
                
                if (rank === 1) medal = 'ü•á';
                else if (rank === 2) medal = 'ü•à';
                else if (rank === 3) medal = 'ü•â';

                const date = new Date(result.completed_at).toLocaleDateString('ru-RU');
                
                tableHTML += `
                    <tr>
                        <td><span class="rank-medal">${medal}</span>${rank}</td>
                        <td>${result.player_name}</td>
                        <td>${result.score}/${result.total_questions}</td>
                        <td>${result.percentage}%</td>
                        <td>${date}</td>
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';
            container.innerHTML = tableHTML;
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É
        function restartQuiz() {
            showScreen('loginScreen');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞
        function showLogin() {
            showScreen('loginScreen');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            console.log('window.supabase:', window.supabase); // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ undefined!
        };
    </script>
</body>
</html>
